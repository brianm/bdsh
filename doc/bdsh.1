.ie \n(.g .ds Aq \(aq
.el .ds Aq '
.TH bdsh 1  "bdsh 0.2.6" 
.SH NAME
bdsh \- Better Distributed Shell \- run commands on multiple hosts via SSH
.SH SYNOPSIS
\fBbdsh\fR [\fB\-\-watch\fR] [\fB\-o\fR|\fB\-\-output\-dir\fR] [\fB\-k\fR|\fB\-\-keep\fR] [\fB\-\-no\-watch\fR] [\fB\-h\fR|\fB\-\-help\fR] [\fB\-V\fR|\fB\-\-version\fR] [\fIHOST_SOURCE\fR] [\fITAG_FILTER\fR] [\fICOMMAND\fR] 
.SH DESCRIPTION
Better Distributed Shell \- run commands on multiple hosts via SSH
.SH OPTIONS
.TP
\fB\-\-watch\fR \fI<WATCH>\fR
Watch an output directory instead of running commands
.TP
\fB\-o\fR, \fB\-\-output\-dir\fR \fI<OUTPUT_DIR>\fR
Output directory (default: temp)
.TP
\fB\-k\fR, \fB\-\-keep\fR
Keep output directory on exit
.TP
\fB\-\-no\-watch\fR
Disable watch window (window 0 with consensus view)
.TP
\fB\-h\fR, \fB\-\-help\fR
Print help
.TP
\fB\-V\fR, \fB\-\-version\fR
Print version
.TP
[\fIHOST_SOURCE\fR]
Host source: @file, @"cmd", inline (h1,h2), or omit for hosts file
.TP
[\fITAG_FILTER\fR]
Tag filter: :tag, :t1:t2 (AND), :t1,:t2 (OR)
.TP
[\fICOMMAND\fR]
Command to run on all hosts
.SH VERSION
v0.2.6

.SH "EXAMPLES"
.PP
Run 'uptime' on hosts from config file:
.RS
.PP
.nf
bdsh \-\- uptime
.fi
.RE
.PP
Run on specific hosts inline:
.RS
.PP
.nf
bdsh web1,web2,db1 \-\- df \-h
.fi
.RE
.PP
Run on hosts tagged :web from config:
.RS
.PP
.nf
bdsh :web \-\- systemctl status nginx
.fi
.RE
.PP
Run on hosts from a file:
.RS
.PP
.nf
bdsh @\./my\-hosts\.txt \-\- whoami
.fi
.RE
.PP
Run on hosts from a command:
.RS
.PP
.nf
bdsh @'aws ec2 describe\-instances \-\-query \.\.\.' \-\- uname \-a
.fi
.RE
.PP
Watch existing output directory:
.RS
.PP
.nf
bdsh \-\-watch /tmp/bdsh\-output
.fi
.RE

.SH "HOST SOURCES"
.PP
If no source is specified, hosts are loaded from `\f[CR]~/\.config/bdsh/hosts\fP`\.
.RS
.Bl
.IP \(bu 4
\fB@/path/to/file\fP \- Read hosts from file\. If executable, run it and parse stdout\.
.El
.Bl
.IP \(bu 4
\fB@'command'\fP \- Run shell command, parse stdout as hosts\.
.El
.Bl
.IP \(bu 4
\fBhost1,host2,\.\.\.\fP \- Inline comma\-separated hostnames (tags not supported)\.
.El
.RE

.SH "HOSTS FILE FORMAT"
.PP
The hosts file contains one host per line with optional tags:
.RS
.PP
.nf
# Web servers
web1\.example\.com :web :prod
web2\.example\.com :web :prod

# Database servers
db1\.example\.com :db :prod
db2\.example\.com :db :staging

# Untagged host
admin\.example\.com
.fi
.RE
.PP
Lines starting with `\f[CR]#\fP`, `\f[CR]//\fP`, or `\f[CR];\fP` are comments\. Tags start with `\f[CR]:\fP` and
are whitespace\-separated after the hostname\. If the hosts file is executable,
bdsh runs it and parses stdout\.

.SH "TAG FILTERING"
.PP
Tags filter which hosts to target\. Filters are the second positional argument,
or the first argument if it starts with ':'\.
.RS
.Bl
.IP \(bu 4
\fB:tag\fP \- Hosts with tag
.El
.Bl
.IP \(bu 4
\fB:t1:t2\fP \- Hosts with t1 AND t2
.El
.Bl
.IP \(bu 4
\fB:t1,:t2\fP \- Hosts with t1 OR t2
.El
.Bl
.IP \(bu 4
\fB:t1:t2,:t3\fP \- Hosts with (t1 AND t2) OR t3
.El
.RE
.PP
Examples:
.RS
.PP
.nf
bdsh :web \-\- cmd              # Hosts tagged :web
bdsh :web:prod \-\- cmd         # Hosts with BOTH :web AND :prod
bdsh :web,:db \-\- cmd          # Hosts with :web OR :db
bdsh @hosts\.txt :prod \-\- cmd  # From file, filtered by :prod
.fi
.RE

.SH "WATCH MODE"
.PP
The watch window (window 0) shows a live consensus view of all host output\.
Lines that differ between hosts are highlighted\. Press 'q' to quit, 'K' to
keep the output directory, or switch to a host window for full interaction\.
.PP
Use `\f[CR]\-\-watch\fP` to view an existing output directory without running commands\.
Use `\f[CR]\-\-no\-watch\fP` to disable the watch window entirely\.

.SH "KEYBOARD SHORTCUTS"
.PP
These shortcuts work in the watch window:
.RS
.Bl
.IP \(bu 4
\fBq\fP \- Quit and clean up
.El
.Bl
.IP \(bu 4
\fBK\fP \- Keep output directory on exit
.El
.Bl
.IP \(bu 4
\fBj/k\fP \- Scroll down/up
.El
.Bl
.IP \(bu 4
\fBg/G\fP \- Jump to top/bottom
.El
.Bl
.IP \(bu 4
\fBTab\fP \- Cycle through hosts showing per\-host view
.El
.Bl
.IP \(bu 4
\fB1\-9\fP \- Jump to specific host
.El
.RE

.SH "OUTPUT DIRECTORY"
.PP
By default, bdsh creates a temporary directory for output\. Each host gets
a subdirectory containing:
.RS
.Bl
.IP \(bu 4
\fBout\.log\fP \- Captured terminal output
.El
.Bl
.IP \(bu 4
\fBstatus\fP \- Current status (pending/running/success/failed)
.El
.Bl
.IP \(bu 4
\fBmeta\.json\fP \- Timing and exit code information
.El
.Bl
.IP \(bu 4
\fBcommand\fP \- The wrapper script that was executed
.El
.RE
.PP
Use `\f[CR]\-o/\-\-output\-dir\fP` to specify a directory, and `\f[CR]\-k/\-\-keep\fP` to preserve it\.

.SH "FILES"
.RS
.Bl
.IP \(bu 4
\fB~/\.config/bdsh/hosts\fP \- Default hosts file\. Can be plain text or executable\.
.El
.RE

.SH "SEE ALSO"
.PP
ssh(1), tmux(1)
